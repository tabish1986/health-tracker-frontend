<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords"
        content="wrappixel, admin dashboard, html css dashboard, web dashboard, bootstrap 5 admin, bootstrap 5, css3 dashboard, bootstrap 5 dashboard, Ample lite admin bootstrap 5 dashboard, frontend, responsive bootstrap 5 admin template, Ample admin lite dashboard bootstrap 5 dashboard template">
    <meta name="description"
        content="Ample Admin Lite is powerful and clean admin dashboard template, inpired from Bootstrap Framework">
    <meta name="robots" content="noindex,nofollow">
    <title>Health Watch</title>
    <link rel="canonical" href="https://www.wrappixel.com/templates/ample-admin-lite/" />   
    <link rel="icon" type="image/png" sizes="16x16" href="plugins/images/favicon.png">
    <link href="css/style.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>

<body>   
    <div class="preloader">
        <div class="lds-ripple">
            <div class="lds-pos"></div>
            <div class="lds-pos"></div>
        </div>
    </div>   
    <div id="main-wrapper" data-layout="vertical" data-navbarbg="skin5" data-sidebartype="full"
        data-sidebar-position="absolute" data-header-position="absolute" data-boxed-layout="full">  

        <header class="topbar" data-navbarbg="skin5" style="height: 0px;">
            <nav class="navbar top-navbar navbar-expand-md navbar-dark">
                <div class="navbar-header" data-logobg="skin6">                   
                    <a class="navbar-brand" href="admin-configuration.html">                        
                        <b class="logo-icon">
                            <!-- Dark Logo icon -->
                            <img src="plugins/images/logo-icon.png" alt="homepage" />
                        </b>                        
                        <span class="logo-text">                           
                            <img src="plugins/images/logo-text.png" alt="homepage" />
                        </span>
                    </a>                   
                    <a class="nav-toggler waves-effect waves-light text-dark d-block d-md-none"
                        href="javascript:void(0)"><i class="ti-menu ti-close"></i></a>
                </div>                
            </nav>
        </header>
        
        <aside class="left-sidebar" data-sidebarbg="skin6">            
            <div class="scroll-sidebar">               
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        <li class="sidebar-item pt-2" style="margin-bottom: 5px;">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link">
                                <i class="fas fa-user-circle" aria-hidden="true"></i>
                                <span class="hide-menu" style="color: cornflowerblue; font-size:medium; color: rgb(40, 206, 128); " id="userTitle">Welcome, User</span>
                            </a>
                        </li>    
                        <li class="sidebar-item" style="background-color: rgba(179, 213, 243, 0.846);">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="admin-configuration.html"
                                aria-expanded="false">
                                <i class="fas fa-user" aria-hidden="true"></i>
                                <span class="hide-menu" style="color: black; font-size: medium; font-weight: bold;">System Configuration</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="changePassword.html"
                                aria-expanded="false">
                                <i class="fas fa-edit" aria-hidden="true"></i>
                                <span class="hide-menu" style="color: black; font-size: medium;">Change Password</span>
                            </a>
                        </li>
                        <li class="sidebar-item" data-toggle='modal' data-target='#myModal' type="button">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link"
                                aria-expanded="false">
                                <i class="fas fa-lock" aria-hidden="true"></i>
                                <span class="hide-menu" style="color: black; font-size: medium;">Logout</span>
                            </a>
                        </li>                                                            
                    </ul>

                </nav>                
            </div>            
        </aside>
       
        <div class="page-wrapper">

            <div class="page-breadcrumb" style="background-color: rgba(255, 0, 0, 0.546);">
                <div class="row align-items-center">
                    <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
                        <h4 class="page-title">Administrator</h4>
                    </div>                    
                </div>                
            </div>

            <div class="container-fluid" style="height: 680px;">
                    <div>
                        <div class="modal-content">
                            <div class="alert alert-primary">            
                                <h4 class="modal-title">System Configuration</h4>
                              </div>
                            <div class="modal-body">
                                <form id="formContent" class="needs-validation1" novalidate>
                                    <div class="mb-2" style="text-align: center;">
                                        <label style="text-align: center; background-color:#dbe7f0; color: rgb(0, 110, 174); font-size:small; font-weight:600; display: none;" id="profileError">Unable to save profile</label>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                          <label for="inputName">SMS Gateway Client ID</label>
                                          <input type="text" class="form-control" id="inputClientID" maxlength="120" onkeypress="return /[0-9a-zA-Z \-_=@!]/i.test(event.key)" required>
                                        </div>
                                        <div class="form-group col-md-6">
                                          <label for="inputEmail">SMS Gateway Authorization Key</label>  
                                          <input type="text" class="form-control" id="inputToken" maxlength="120" onkeypress="return /[0-9a-zA-Z \-_=@!]/i.test(event.key)" required>
                                        </div>
                                    </div> 
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                          <label for="inputMobNo">SMS Gateway Mobile Number</label>
                                          <input type="text" class="form-control" id="inputMobNo" maxlength="20" onkeypress="return /[0-9\+]/i.test(event.key)" required>
                                        </div>                                        
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-success" data-dismiss="modal" id="saveProfile">Save</button>                                
                                    </div>
                                  </form>
                            </div>                            
                        </div>                       
                    </div>
            </div>      
        </div>      
    </div>
   
    <script src="assets/custom/js/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>    
    <script src="js/custom.js"></script> 
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>  
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script>

        $(document).ready(function() {
            loadUserTitle();
            loadConfiguration();
            validationHandler();
        });

        function validationHandler()
        {
            'use strict';
            window.addEventListener('submit', function(event) {
            
            var forms;

            if (event.submitter.id == 'saveProfile')                        
                forms = document.getElementsByClassName('needs-validation1');
            else if (event.submitter.id == 'saveBasics')
                forms = document.getElementsByClassName('needs-validation2');

            //var forms = document.getElementsByClassName('needs-validation');
            var validation = Array.prototype.filter.call(forms, function(form) {
            
                if (form.checkValidity() === false) {     
                    event.preventDefault();
                    event.stopPropagation();
                }
                else
                {   
                    event.preventDefault();
                    saveConfiguration()
                }
                form.classList.add('was-validated');                    
            });
            }, false);
        }
        
        var session_userId = window.sessionStorage.getItem("session_userid");
        var session_token = "Bearer " + window.sessionStorage.getItem("seession_token");

        function loadUserTitle()
        {
            $('#userTitle').text("Welcome, " + window.sessionStorage.getItem("seession_name"));
        }

        function loadConfiguration()
        {
            $.ajax({
                    type:"GET",
                    beforeSend: function(request){
                        request.setRequestHeader("Authorization",session_token);
                    },
                    url:"http://localhost:8081/api/v1/users/" + session_userId + "/administrators/configurations",
                    data: '{}',
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    crossDomain: false,
                    success: function(response){
                       
                        $('#inputClientID').val(response.ClientID);
                        $('#inputToken').val(response.Token);
                        $('#inputMobNo').val(response.MobileNo);
                    },
                    error: function (response){
                        alert('Technical Error: Unable to change password');
                    }
                });
        }
        function saveConfiguration()
        {
            var clientID = $('#inputClientID').val();
            var token = $('#inputToken').val();
            var mobNo = $('#inputMobNo').val();            

            data = {
                ClientID   : clientID,
                Token      : token,
                MobileNo   : mobNo                
            }

            $.ajax({
                    type:"POST",
                    beforeSend: function(request){
                        request.setRequestHeader("Authorization",session_token);
                    },
                    url:"http://localhost:8081/api/v1/users/" + session_userId + "/administrators/configurations",
                    data: JSON.stringify(data),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    crossDomain: false,
                    success: function(response){
                        $('#profileError').text('Configuration updated successfully'); 
                        $('#profileError').show();
                    },
                    error: function (response){                        
                            alert('Technical Error: Unable to save changes');
                    }
                });
        }
</script>

<div class="container">      
    <div class="modal fade" id="myModal" role="dialog">
      <div class="modal-dialog modal-sm">
        <div class="modal-content">
          <div class="modal-header alert-danger">
            
            <h4 class="modal-title">Confirmation</h4>
          </div>
          <div class="modal-body ">
            <p>Are you sure you want to Logout ?</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-success" data-dismiss="modal" onclick="window.location.href='index.html'">Yes</button>
            <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
          </div>
        </div>
      </div>
    </div>
  </div>
    
</body>

</html>